# Chiaki Switch 第三方手柄震动和陀螺仪使用指南

## 📦 编译步骤

### 1. 环境准备
确保你有以下环境：
- 已安装devkitPro开发环境
- 已配置好Switch开发工具链
- 已克隆chiaki-switch项目

### 2. 编译命令
```bash
# 在项目根目录执行
mkdir -p build-switch
cd build-switch
cmake .. -DCMAKE_TOOLCHAIN_FILE=/opt/devkitpro/cmake/Switch.cmake -DCMAKE_BUILD_TYPE=Release
make -j$(nproc)
```

### 3. 编译结果
编译完成后会得到：`chiaki-switch.nro`

## 🎮 安装到Switch

### 方法一：通过SD卡
1. 将`chiaki-switch.nro`复制到SD卡的`/switch/chiaki/`目录下
2. 确保目录结构：
   ```
   /switch/
   └── chiaki/
       ├── chiaki-switch.nro
       └── chiaki.conf (可选，配置文件)
   ```

### 方法二：通过FTP
1. 使用FTP工具连接Switch
2. 上传到`/switch/chiaki/`目录

## ⚙️ 配置文件设置

### 创建配置文件
在`/switch/chiaki/`目录下创建`chiaki.conf`：

```ini
# 全局设置
video_resolution = "720p"
video_fps = 60
haptic = 2  # 开启震动 (2=强, 1=弱, 0=关闭)

# 添加你的PS主机
[PS5]
host_addr = "192.168.1.100"  # 替换为你的PS IP
target = "1"  # 1=PS5, 0=PS4
video_resolution = "1080p"
haptic = 2  # 启用震动支持

[PS4]
host_addr = "192.168.1.101"  # 替换为你的PS IP
target = "0"
video_resolution = "720p"
haptic = 2  # 启用震动支持
```

## 🎯 使用步骤

### 1. 首次连接
1. 在Switch上启动`chiaki-switch.nro`
2. 确保PS主机和Switch在同一局域网
3. 在PS主机上：设置 → 远程游玩 → 启用远程游玩
4. 在PS主机上：设置 → 远程游玩 → 添加设备 → 获取PIN码

### 2. 连接设置
1. 运行chiaki-switch
2. 输入PS主机的IP地址
3. 输入PSN账号ID（8位数字）
4. 输入PIN码进行配对

### 3. 控制器支持
**现在支持的控制器类型：**
- ✅ Switch Pro Controller
- ✅ 第三方Pro手柄
- ✅ Joy-Con组合
- ✅ 独立Joy-Con
- ✅ 手持模式

### 4. 震动功能测试
连接成功后：
- 在游戏中按手柄按键应该有震动反馈
- 震动强度通过配置文件中的`haptic`值调整
- 支持左右马达独立控制

### 5. 陀螺仪功能
- 支持所有控制器的陀螺仪输入
- 自动识别控制器类型
- 无需额外设置

## 🔧 故障排除

### 无法震动
1. 检查配置文件中的`haptic = 2`
2. 确保手柄支持震动功能
3. 重启chiaki-switch应用

### 陀螺仪不工作
1. 确认手柄有陀螺仪功能
2. 检查手柄连接状态
3. 重启应用重新初始化

### 连接问题
1. 检查IP地址是否正确
2. 确保PS主机远程游玩已启用
3. 检查网络连接

## 📱 快捷操作
- **L+R+START**：打开菜单
- **HOME**：返回Switch主界面
- **截图键**：截图
- **震动测试**：按PS键可以测试震动功能